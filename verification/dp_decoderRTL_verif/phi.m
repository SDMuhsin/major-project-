%subfunction for making AR4JA H matrix
%Phi table from CCSDS document.

%Phi Table function: 
   function numbr = phi(k,index,mval)
        a1 = [1 3 1 59 16 160 108 226 1148 0 0 0 0 0 0 0
2 0 22 18 103 241 126 618 2032 27 32 53 182 375 767 1822
3 1 0 52 105 185 238 404 249 30 21 74 249 436 227 203
4 2 26 23 0 251 481 32 1807 28 36 45 65 350 247 882
5 2 0 11 50 209 96 912 485 7 30 47 70 260 284 1989
6 3 10 7 29 103 28 950 1044 1 29 0 141 84 370 957
7 0 5 22 115 90 59 534 717 8 44 59 237 318 482 1705
8 1 18 25 30 184 225 63 873 20 29 102 77 382 273 1083
9 0 3 27 92 248 323 971 364 26 39 25 55 169 886 1072
10 1 22 30 78 12 28 304 1926 24 14 3 12 213 634 354
11 2 3 43 70 111 386 409 1241 4 22 88 227 67 762 1942
12 0 8 14 66 66 305 708 1769 12 15 65 42 313 184 446
13 2 25 46 39 173 34 719 532 23 48 62 52 242 696 1456
14 3 25 62 84 42 510 176 768 15 55 68 243 188 413 1940
15 0 2 44 79 157 147 743 1138 15 39 91 179 1 854 1660
16 1 27 12 70 174 199 759 965 22 11 70 250 306 544 1661
17 2 7 38 29 104 347 674 141 31 1 115 247 397 864 587
18 0 7 47 32 144 391 958 1527 3 50 31 164 80 82 708
19 1 15 1 45 43 165 984 505 29 40 121 17 33 1009 1466
20 2 10 52 113 181 414 11 1312 21 62 45 31 7 437 433
21 0 4 61 86 250 97 413 1840 2 27 56 149 447 36 1345
22 1 19 10 1 202 158 925 709 5 38 54 105 336 562 867
23 2 7 55 42 68 86 687 1427 11 40 108 183 424 816 1551
24 1 9 7 118 177 168 752 989 26 15 14 153 134 452 2041
25 2 26 12 33 170 506 867 1925 9 11 30 177 152 290 1383
26 3 17 2 126 89 489 323 270 17 18 116 19 492 778 1790];


a2 =[1 3 0 0 0 0 0 0 0 0 0 0 0 0 0 0
2 0 12 46 8 35 219 254 318 13 44 35 162 312 285 1189
3 1 30 45 119 167 16 790 494 19 51 97 7 503 554 458
4 2 18 27 89 214 263 642 1467 14 12 112 31 388 809 460
5 2 10 48 31 84 415 248 757 15 15 64 164 48 185 1039
6 3 16 37 122 206 403 899 1085 20 12 93 11 7 49 1000
7 0 13 41 1 122 184 328 1630 17 4 99 237 185 101 1265
8 1 9 13 69 67 279 518 64 4 7 94 125 328 82 1223
9 0 7 9 92 147 198 477 689 4 2 103 133 254 898 874
10 1 15 49 47 54 307 404 1300 11 30 91 99 202 627 1292
11 2 16 36 11 23 432 698 148 17 53 3 105 285 154 1491
12 0 18 10 31 93 240 160 777 20 23 6 17 11 65 631
13 2 4 11 19 20 454 497 1431 8 29 39 97 168 81 464
14 3 23 18 66 197 294 100 659 22 37 113 91 127 823 461
15 0 5 54 49 46 479 518 352 19 42 92 211 8 50 844
16 1 3 40 81 162 289 92 1177 15 48 119 128 437 413 392
17 2 29 27 96 101 373 464 836 5 4 74 82 475 462 922
18 0 11 35 38 76 104 592 1572 21 10 73 115 85 175 256
19 1 4 25 83 78 141 198 348 17 18 116 248 419 715 1986
20 2 8 46 42 253 270 856 1040 9 56 31 62 459 537 19
21 0 2 24 58 124 439 235 779 20 9 127 26 468 722 266
22 1 11 33 24 143 333 134 476 18 11 98 140 209 37 471
23 2 11 18 25 63 399 542 191 31 23 23 121 311 488 1166
24 1 3 37 92 41 14 545 1393 13 8 38 12 211 179 1300
25 2 15 35 38 214 277 777 1752 2 7 18 41 510 430 1033
26 3 13 21 120 70 412 483 1627 18 24 62 249 320 264 1606];
    if (index==0)
        m=3;
        mat = a1;
    elseif(index == 1)
    m=10; 
    mat = a1;

    elseif(index == 2)
    m=3; 
    mat = a2;

    elseif(index == 3)
    m=10;
    mat = a2;
    
    end%ifelseif.. end
 
    numbr = mat(k,m+log2(mval/(2^7)));
end%function